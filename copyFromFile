#!/bin/bash

RED='\033[0;31m'
GREEN='\033[0;32m'
ORANGE='\033[0;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
WHITE='\033[0;37m'
NC='\033[0m' # no color


if [[ $1 == "--help" ]]; then
	echo -e "\e[1mHelp\n\e[0m"

	echo -e "This script copies lines from a file to your clipboard using 'xclip'.\n"

	echo -e "\e[4m\e[1mUsage:\e[0m"
    	echo -e "  \e[4mcopyFromFile [START_LINE] [END_LINE] [FILE]\e[0m\n"

   	echo -e "Copies lines from <start_line> to <end_line> in <file> to the clipboard.\n"

	echo -e "\e[4m\e[1mExample:\e[0m\n"
    	echo -e "  \e[1mcopyFromFile 10 30 file.txt\e[0m\n"
    	echo -e "OR\n"
    	echo -e "  \e[1mcpff 10 30 file.txt\e[0m\n"
	exit 0
fi



if [[ $# -eq 1 || $1 == "--update" ]]; then
	#echo -e "The Update starts at" + date +"%H:%M:%S"
	#echo -e "\e[1mUpdating...\n\e[0m"

	sleep 1

	git clone https://github.com/FabrizioJordan/copyFromFile.git
	cd copyFromFile
	sudo cp copyFromFile /usr/local/bin/copyFromFile
	cd ..
	rm -r copyFromFile

	#echo -e "The Update ends at"
	#echo -e date +"%H:%M:%S"

	exit 0
fi

## Arguments


if [ $# -ge 3 ]; then
	# validations:

	# is the 1st and 2nd args nums?
	if ! [[ $1 =~ ^[0-9]+$ ]] || ! [[ $2 =~ ^[0-9]+$ ]]; then
        	echo "The starting and ending lines must be numeric values. Operation canceled."
        	exit 1
    	fi

	# is the 3rd arg a file?
	if [[ -f $3 ]]; then
		sed -n "$1,$2p" $3 | xclip -selection clipboard
		echo "Content copied from line $1 to $2 of $3."
	else
		echo "The file could not be detected or found. Operation canceled."
	fi
fi

if [[ $# -ge 1 && $# -lt 3 ]]; then
	echo -e "${RED}\e[1mError.${NC}\n"

	echo -e "Use 'copyFromFile --help' to display the Help guide.\n"

    	echo -e "And remember:"
	echo -e "You need to use three arguments.\n"
    	exit 1
fi

if ! command -v xclip &> /dev/null; then
    echo "xclip is not installed. Please install it first."
    exit 1
fi


echo ""

# It is recommended to create an alias for this script, such as 'cpff'.
